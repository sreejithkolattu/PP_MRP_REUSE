/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("i2d.pp.mrpcockpit.reuse.view.ViewStateHandler");i2d.pp.mrpcockpit.reuse.view.ViewStateHandler={i18NCommonReuseModel:new sap.ui.model.resource.ResourceModel({bundleUrl:jQuery.sap.getModulePath("i2d.pp.mrpcockpit.reuse")+"/"+"i18n/i18n.properties"}),getViewState:function(c,v,d,V,s,t,n){if(V!==""&&(s=="")){this.getViewStateFromContainer(c,t,n,d,v,V)}else if(s!==""&&(V=="")){i2d.pp.mrpcockpit.reuse.view.VariantHandler.getVariantByName(c.bind(this),v,s)}else{this.getViewStateFromContainer(c,t,n,d)}},saveViewStateInContainer:function(c,v,t,n,V){if(!this.oPersonalizationService){this.oPersonalizationService=sap.ushell.Container.getService("Personalization")}if(this.oPersonalizationService.getContainer){this.oPersonalizationService.getContainer(t,{validity:0}).fail(function(){jQuery.sap.log.error("Loading personalization data failed.")}).done(function(C){C.setItemValue("ViewState",v);C.save().done(function(){jQuery.sap.log.info("saveViewStateInContainer: oContainer.save");if(n>0){this.oPersonalizationService.getContainer(t,{validity:n}).fail(function(){jQuery.sap.log.error("Loading personalization data failed.")}).done(function(C){jQuery.sap.log.info("saveViewStateInContainer: this.oPersonalizationService.getContainer");C.setItemValue("ViewState",v);C.save().done(function(){jQuery.sap.log.info("saveViewStateInContainer: oContainer.save");if(c){c(true)}})}.bind(this))}else{if(c){c(true)}}}.bind(this))}.bind(this))}},deleteViewStateInContainer:function(c,t,n){if(!this.oPersonalizationService){this.oPersonalizationService=sap.ushell.Container.getService("Personalization")}if(this.oPersonalizationService.getContainer){this.oPersonalizationService.getContainer(t,{validity:0}).fail(function(){jQuery.sap.log.error("Loading personalization data failed.")}).done(function(C){C.delItem("ViewState");C.save().done(function(){if(n>0){this.oPersonalizationService.getContainer(t,{validity:n}).fail(function(){jQuery.sap.log.error("Loading personalization data failed.")}).done(function(C){C.delItem("ViewState");C.save().done(function(){if(c){c(true)}})}.bind(this))}else{if(c){c(true)}}}.bind(this))}.bind(this))}},getViewStateFromContainer:function(c,t,n,d,v,V){if(!this.oPersonalizationService){this.oPersonalizationService=sap.ushell.Container.getService('Personalization')}if(this.oPersonalizationService.getContainer){this.oPersonalizationService.getContainer(t,{validity:0}).done(function(C){var s=C.getItemValue("ViewState");var a="";if(c){if(s){if(s.VariantName){a=s.VariantName}c(true,s,a)}else{this.oPersonalizationService.getContainer(t,{validity:n}).done(function(C){var s=C.getItemValue("ViewState");var a="";if(c){if(s){if(s.VariantName){a=s.VariantName}c(true,s,a)}else{if(V){i2d.pp.mrpcockpit.reuse.view.VariantHandler.getVariantByID(c.bind(this),v,V)}else{c(true,d,"")}}}}.bind(this)).fail(function(){if(c){c(true,d,"")}}.bind(this))}}}.bind(this)).fail(function(){if(c){c(true,d,"")}}.bind(this))}else{if(V){i2d.pp.mrpcockpit.reuse.view.VariantHandler.getVariantByID(c.bind(this),v,V)}else{c(true,d,"")}}}};
