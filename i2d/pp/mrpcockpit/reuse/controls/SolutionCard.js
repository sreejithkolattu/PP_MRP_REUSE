/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("i2d.pp.mrpcockpit.reuse.util.CommonConstants");sap.ui.core.Control.extend("i2d.pp.mrpcockpit.reuse.controls.SolutionCard",{metadata:{properties:{"myCard":"object","title":"string","subTitle":"string","actionText":"string","materialShortageSolutionType":"string","proposalPriority":"string","state":"string","status":"string","tooltipRating":"string","tooltipAction":"string"},aggregations:{"ctrlStars":{type:"sap.m.RatingIndicator",multiple:false},"ctrlIcon":{type:"sap.ui.core.Icon",multiple:false}}},getTapLocation:function(e){var t="";var l=jQuery("#"+this.getId());var c=l.children();var C=null;if(l[0].id===e.target.id){t=this.Constants.CARD_AREA_INSIDE}else{for(var i=0;i<c.length;i++){C=c[i];if(C.contains(e.target)){switch(C.className){case"sapMRPSCTitle":case"sapMRPSCSubtitle":case"sapMRPSCRating":t=this.Constants.CARD_AREA_INSIDE;break;case"sapMRPSCAction":t=this.Constants.CARD_AREA_EXECUTE;break;case"sapMRPSCIcon":t=this.Constants.CARD_AREA_ICON;break;default:t=""}}}}return t},ontap:function(e){var c=this.getMyCard();if(this.isSolutionCardLocked()){return}var t=this.getTapLocation(e);switch(t){case this.Constants.CARD_AREA_EXECUTE:this._triggerSolutionCardExecution(c);break;case this.Constants.CARD_AREA_INSIDE:case this.Constants.CARD_AREA_ICON:if(this.getMaterialShortageSolutionType()===this.Constants.SOLUTIONTYPE_ACCEPT_REMOVE){return}if(this.getMaterialShortageSolutionType()===this.Constants.SOLUTIONTYPE_ACCEPT){this._triggerSolutionCardCancelPreview();this.setState(this.Constants.CARD_STATE_ENABLED);return}if(this.hasState(this.Constants.CARD_STATE_ACTIVE)){this._triggerSolutionCardCancelPreview();this.setState(this.Constants.CARD_STATE_ENABLED)}else{this._triggerSolutionCardRunPreview(c);this.setState(this.Constants.CARD_STATE_ACTIVE)}break}},_triggerSolutionCardExecution:function(c){var b=sap.ui.getCore().getEventBus();b.publish(this.Constants.EVENT_CHANNELID_SOLCARD,this.Constants.EVENT_EVENTID_DIALOG_START);b.publish(this.Constants.EVENT_CHANNELID_SOLCARD,this.Constants.EVENT_EVENTID_EXECUTE,{model:c})},_triggerSolutionCardRunPreview:function(c){var b=sap.ui.getCore().getEventBus();b.publish(this.Constants.EVENT_CHANNELID_CARD_PREVIEW,this.Constants.EVENT_EVENTID_RUN,{model:c})},_triggerSolutionCardCancelPreview:function(){var b=sap.ui.getCore().getEventBus();b.publish(this.Constants.EVENT_CHANNELID_CARD_PREVIEW,this.Constants.EVENT_EVENTID_CANCEL,{model:null})},init:function(){var c=new sap.m.RatingIndicator({maxValue:2,iconSize:"1.125rem",value:0,enabled:false});this.setCtrlStars(c);this.setProposalPriority("0");this.Constants=i2d.pp.mrpcockpit.reuse.util.CommonConstants},isSolutionCardActive:function(){return this.hasState(this.Constants.CARD_STATE_ACTIVE)},isSolutionCardLocked:function(){return this.hasState(this.Constants.CARD_STATE_LOCKED)},isSolutionCardClicked:function(){return this.hasState(this.Constants.CARD_STATE_CLICKED)},hasState:function(s){var r=false;switch(s){case this.Constants.CARD_STATE_ENABLED:r=this.hasStyleClass("sapMRPSCStatusEnabled");break;case this.Constants.CARD_STATE_DISABLED:r=this.hasStyleClass("sapMRPSCStatusDisabled");break;case this.Constants.CARD_STATE_ACTIVE:r=this.hasStyleClass("sapMRPSCStatusActive");break;case this.Constants.CARD_STATE_LOCKED:r=this.hasStyleClass("sapMRPSCStatusLocked");break;case this.Constants.CARD_STATE_CLICKED:r=this.hasStyleClass("sapMRPSCStatusClicked");break;case this.Constants.CARD_STATE_HIDDEN:r=this.hasStyleClass("sapMRPSCStatusHidden");break;default:r=false;break}return r},setState:function(s){switch(s){case this.Constants.CARD_STATE_ENABLED:if(this.hasStyleClass("sapMRPSCStatusHidden")){this.removeStyleClass("sapMRPSCStatusHidden")}if(this.hasStyleClass("sapMRPSCStatusDisabled")){this.removeStyleClass("sapMRPSCStatusDisabled")}if(this.hasStyleClass("sapMRPSCStatusActive")){this.removeStyleClass("sapMRPSCStatusActive")}if(this.hasStyleClass("sapMRPSCStatusLocked")){this.removeStyleClass("sapMRPSCStatusLocked")}if(this.hasStyleClass("sapMRPSCStatusClicked")){this.removeStyleClass("sapMRPSCStatusClicked")}if(!this.hasStyleClass("sapMRPSCStatusEnabled")){this.addStyleClass("sapMRPSCStatusEnabled")}break;case this.Constants.CARD_STATE_DISABLED:if(!this.hasStyleClass("sapMRPSCStatusDisabled")){this.addStyleClass("sapMRPSCStatusDisabled")}if(this.hasStyleClass("sapMRPSCStatusEnabled")){this.removeStyleClass("sapMRPSCStatusEnabled")}if(this.hasStyleClass("sapMRPSCStatusActive")){this.removeStyleClass("sapMRPSCStatusActive")}if(this.hasStyleClass("sapMRPSCStatusLocked")){this.removeStyleClass("sapMRPSCStatusLocked")}if(this.hasStyleClass("sapMRPSCStatusClicked")){this.removeStyleClass("sapMRPSCStatusClicked")}break;case this.Constants.CARD_STATE_ACTIVE:if(!this.hasStyleClass("sapMRPSCStatusActive")){this.addStyleClass("sapMRPSCStatusActive")}if(this.hasStyleClass("sapMRPSCStatusEnabled")){this.removeStyleClass("sapMRPSCStatusEnabled")}if(this.hasStyleClass("sapMRPSCStatusDisabled")){this.removeStyleClass("sapMRPSCStatusDisabled")}if(this.hasStyleClass("sapMRPSCStatusLocked")){this.removeStyleClass("sapMRPSCStatusLocked")}if(this.hasStyleClass("sapMRPSCStatusClicked")){this.removeStyleClass("sapMRPSCStatusClicked")}break;case this.Constants.CARD_STATE_LOCKED:if(this.hasStyleClass("sapMRPSCStatusEnabled")){this.removeStyleClass("sapMRPSCStatusEnabled")}if(this.hasStyleClass("sapMRPSCStatusDisabled")){this.removeStyleClass("sapMRPSCStatusDisabled")}if(this.hasStyleClass("sapMRPSCStatusClicked")){this.removeStyleClass("sapMRPSCStatusClicked")}if(this.hasStyleClass("sapMRPSCStatusActive")){this.removeStyleClass("sapMRPSCStatusActive")}if(!this.hasStyleClass("sapMRPSCStatusLocked")){this.addStyleClass("sapMRPSCStatusLocked")}break;case this.Constants.CARD_STATE_CLICKED:if(this.hasStyleClass("sapMRPSCStatusDisabled")){this.removeStyleClass("sapMRPSCStatusDisabled")}if(this.hasStyleClass("sapMRPSCStatusLocked")){this.removeStyleClass("sapMRPSCStatusLocked")}if(!this.hasStyleClass("sapMRPSCStatusClicked")){this.addStyleClass("sapMRPSCStatusClicked")}break;case this.Constants.CARD_STATE_HIDDEN:if(!this.hasStyleClass("sapMRPSCStatusHidden")){this.addStyleClass("sapMRPSCStatusHidden")}break}},initCard:function(){var b=this.getModel("Common_i18n").getResourceBundle();var t="";var s="";var a=b.getText("CARD_ACT_CHOOSE");var m=this.getMyCard();var i="";var I=b.getText("CARD_XTOL_PREVIEW");var r="";var A="";var c="";if(m.VendorName){c=m.VendorName}else{c=b.getText("CARD_SUB_UNSOURCED")}var d="";if(m.SupplyingPlant){d=b.getText("CARD_SUB_PLANT",m.SupplyingPlant)}else{d=b.getText("CARD_SUB_UNSOURCED")}if(m.VendorName&&m.SupplyingPlant){c=b.getText("PLANT_LONG",[m.SupplyingPlant,m.VendorName]);d=c}switch(m.MaterialShortageSolutionType){case this.Constants.SOLUTIONTYPE_ACCEPT:t=b.getText("CARD_TIT_ACCEPT");s="";i=this.Constants.CARD_ICON_ACCEPT;I="";a=b.getText("CARD_ACT_CHOOSE");A=b.getText("XTOL_ACCEPT_SOL_CARD");break;case this.Constants.SOLUTIONTYPE_ACCEPT_REMOVE:t=b.getText("CARD_TIT_ACCEPT_REMOVE");s="";i=this.Constants.CARD_ICON_ACCEPT_REMOVE;I="";a=b.getText("CARD_ACT_CANCEL");A=b.getText("XTOL_ACCEPTED_SOL_CARD");break;case this.Constants.SOLUTIONTYPE_PO_CREATE:t=b.getText("CARD_TIT_CREATEPO");s=c;i=this.Constants.CARD_ICON_PROCURE;A=b.getText("SOLUTION_DIALOG_PO_CREATE_TITLE");break;case this.Constants.SOLUTIONTYPE_PO_INCREASE:t=b.getText("CARD_TIT_INCREASE");s=c;i=this.Constants.CARD_ICON_INCREASE;A=b.getText("SOLUTION_DIALOG_PO_INCREASE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_PO_RESCHEDULE:t=b.getText("CARD_TIT_RESCHEDULE");s=c;i=this.Constants.CARD_ICON_RESCHEDULE;A=b.getText("SOLUTION_DIALOG_PO_RESCHEDULE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_PR_CREATE:t=b.getText("CARD_TIT_CREATEPO");s=c;i=this.Constants.CARD_ICON_PROCURE;A=b.getText("SOLUTION_DIALOG_PO_CREATE_TITLE");break;case this.Constants.SOLUTIONTYPE_PR_INCREASE:t=b.getText("CARD_TIT_INCREASE");s=c;i=this.Constants.CARD_ICON_INCREASE;A=b.getText("SOLUTION_DIALOG_PR_INCREASE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_PR_RESCHEDULE:t=b.getText("CARD_TIT_RESCHEDULE");s=c;i=this.Constants.CARD_ICON_RESCHEDULE;A=b.getText("SOLUTION_DIALOG_PR_RESCHEDULE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_TO_CREATE:t=b.getText("CARD_TIT_CREATETO");s=d;i=this.Constants.CARD_ICON_TRANSFER;A=b.getText("SOLUTION_DIALOG_TO_CREATE_TITLE");break;case this.Constants.SOLUTIONTYPE_TO_INCREASE:t=b.getText("CARD_TIT_INCREASE");s=d;i=this.Constants.CARD_ICON_INCREASE;A=b.getText("SOLUTION_DIALOG_TO_INCREASE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_TO_RESCHEDULE:t=b.getText("CARD_TIT_RESCHEDULE");s=d;i=this.Constants.CARD_ICON_RESCHEDULE;A=b.getText("SOLUTION_DIALOG_TO_RESCHEDULE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_TOR_CREATE:t=b.getText("CARD_TIT_CREATETO");s=d;i=this.Constants.CARD_ICON_TRANSFER;A=b.getText("SOLUTION_DIALOG_TO_CREATE_TITLE");break;case this.Constants.SOLUTIONTYPE_TOR_INCREASE:t=b.getText("CARD_TIT_INCREASE");s=d;i=this.Constants.CARD_ICON_INCREASE;A=b.getText("SOLUTION_DIALOG_TOR_INCREASE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_TOR_RESCHEDULE:t=b.getText("CARD_TIT_RESCHEDULE");s=d;i=this.Constants.CARD_ICON_RESCHEDULE;A=b.getText("SOLUTION_DIALOG_TOR_RESCHEDULE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_PO_CHANGE:t=b.getText("CARD_TIT_CHANGE");s=c;i=this.Constants.CARD_ICON_CHANGE;A=b.getText("SOLUTION_DIALOG_PO_CHANGE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_PR_CHANGE:t=b.getText("CARD_TIT_CHANGE");s=c;i=this.Constants.CARD_ICON_CHANGE;A=b.getText("SOLUTION_DIALOG_PR_CHANGE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_TO_CHANGE:t=b.getText("CARD_TIT_CHANGE");s=d;i=this.Constants.CARD_ICON_CHANGE;A=b.getText("SOLUTION_DIALOG_TO_CHANGE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_TOR_CHANGE:t=b.getText("CARD_TIT_CHANGE");s=d;i=this.Constants.CARD_ICON_CHANGE;A=b.getText("SOLUTION_DIALOG_TOR_CHANGE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_PA_CHANGE:t=b.getText("CARD_TIT_CHANGE");s=c;i=this.Constants.CARD_ICON_CHANGE;A=b.getText("SOLUTION_DIALOG_PA_CHANGE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_PROD_CONVERT:t=b.getText("CARD_TIT_CHANGE");s=c;i=this.Constants.CARD_ICON_CHANGE;A=b.getText("SOLUTION_DIALOG_PA_CHANGE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_PROC_CONVERT:t=b.getText("CARD_TIT_CHANGE");s=c;i=this.Constants.CARD_ICON_CHANGE;A=b.getText("SOLUTION_DIALOG_PA_CHANGE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;case this.Constants.SOLUTIONTYPE_REQ_CONVERT:t=b.getText("CARD_TIT_CHANGE");s=c;i=this.Constants.CARD_ICON_CHANGE;A=b.getText("SOLUTION_DIALOG_PA_CHANGE_TITLE",[m.MRPElementExternalID,m.MRPElementItemExternalID]);break;default:t=b.getText("CARD_TIT_UNKNOWN");s=m.MaterialShortageSolutionType;break}switch(m.ProposalPriority){case"0":r=b.getText("CARD_XTOL_RATING_0");break;case"1":r=b.getText("CARD_XTOL_RATING_1");break;case"2":r=b.getText("CARD_XTOL_RATING_2");break;default:r="";break}this.setTitle(t);this.setSubTitle(s);this.setActionText(a);this.setTooltipAction(A);this.setTooltipRating(r);this.setMaterialShortageSolutionType(m.MaterialShortageSolutionType);this.setProposalPriority(m.ProposalPriority);var C=new sap.ui.core.Icon({src:i,tooltip:I});this.setCtrlIcon(C);this.addStyleClass("sapMRPSC");if(m.MaterialShortageSolutionType===this.Constants.SOLUTIONTYPE_ACCEPT||m.MaterialShortageSolutionType===this.Constants.SOLUTIONTYPE_ACCEPT_REMOVE){this.addStyleClass("sapMRPSCTypeAccept")}},renderer:function(r,c){r.write('<div ');r.writeControlData(c);r.writeClasses();r.write(">");r.write('<div ');r.addClass("sapMRPSCIcon");r.writeClasses();r.write(">");r.renderControl(c.getCtrlIcon());r.write("</div>");r.write('<div ');r.addClass("sapMRPSCTitle");r.writeClasses();r.write(">");r.writeEscaped(c.getTitle());r.write("</div>");r.write('<div ');if(c.getMaterialShortageSolutionType()!==c.Constants.SOLUTIONTYPE_ACCEPT){r.addClass("sapMRPSCSubtitle");r.writeClasses()}r.write(">");r.writeEscaped(c.getSubTitle());r.write("</div>");r.write('<div ');r.writeAttributeEscaped("title",c.getTooltipRating());r.addClass("sapMRPSCRating");r.writeClasses();r.write(">");var s=c.getCtrlStars();var p=c.getProposalPriority();var P=parseFloat(p);s.setValue(P);r.renderControl(s);r.write("</div>");r.write("<div ");r.writeAttributeEscaped("title",c.getTooltipAction());r.addClass("sapMRPSCAction");r.writeClasses();r.write(">");r.write('<span ');r.addClass("text");r.writeClasses();r.write(">");r.writeEscaped(c.getActionText());r.write("</span>");r.write("</div>");r.write("</div>")},onBeforeRendering:function(e){},onAfterRendering:function(e){}});
