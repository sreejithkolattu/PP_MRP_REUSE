/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.require("i2d.pp.mrpcockpit.reuse.util.CollaborationHelper");jQuery.sap.require("i2d.pp.mrpcockpit.reuse.util.CommonConstants");jQuery.sap.require("i2d.pp.mrpcockpit.reuse.fragments.DialogRoot");jQuery.sap.require("sap.ca.ui.utils.busydialog");jQuery.sap.require("sap.ca.ui.message.message");jQuery.sap.require("sap.ca.ui.model.type.Number");jQuery.sap.require("sap.ca.ui.model.format.QuantityFormat");i2d.pp.mrpcockpit.reuse.fragments.DialogRoot.extend("i2d.pp.mrpcockpit.reuse.fragments.DialogOrderCreate",{_initializeDialog:function(){var m=this.oDialog.getModel();m.setProperty("/DialogConfigCtrlOptionCreateReq",false);m.setProperty("/DialogConfigCtrlOptionCreateOrd",true);switch(m.getProperty("/MaterialShortageSolutionType")){case this.Constants.SOLUTIONTYPE_PO_CREATE:this.oDialog.setTitle(this.Common_i18n.getText("SOLUTION_DIALOG_PO_CREATE_TITLE"));this.dialogAction=this.Constants.SolutionDialogAction_PO_CREATE;break;case this.Constants.SOLUTIONTYPE_TO_CREATE:this.oDialog.setTitle(this.Common_i18n.getText("SOLUTION_DIALOG_TO_CREATE_TITLE"));this.dialogAction=this.Constants.SolutionDialogAction_TO_CREATE;break}},onOk:function(e){var d=this.oDialog.getModel().getData();if(!this._isScreenDataValid()){if(!this.bDateValid){if(this.bInvalidDateFormat){return}sap.ca.ui.message.showMessageBox({type:sap.ca.ui.message.Type.ERROR,message:this.Common_i18n.getText("SOLUTION_DIALOG_MSG_WRONG_DATE")})}else{sap.ca.ui.message.showMessageBox({type:sap.ca.ui.message.Type.ERROR,message:this.Common_i18n.getText("SOLUTION_DIALOG_MSG_WRONG_QUANTITY_NUMBER")})}return}this.oDialog.close();sap.ca.ui.utils.busydialog.requireBusyDialog({text:this.Common_i18n.getText("SOLUTION_DIALOG_MSG_SAVE_WAITING")});var E="";switch(this.dialogAction){case this.Constants.SolutionDialogAction_PO_CREATE:case this.Constants.SolutionDialogAction_TO_CREATE:E=i2d.pp.mrpcockpit.reuse.util.CollaborationHelper.createPurchaseOrderBatch(d,this._oHandlerOrder);break;case this.Constants.SolutionDialogAction_PR_CREATE:case this.Constants.SolutionDialogAction_TOR_CREATE:E=i2d.pp.mrpcockpit.reuse.util.CollaborationHelper.createPurchaseRequisitionBatch(d,this._oHandlerOrder);break;default:jQuery.sap.log.error("Dialog action "+this.dialogAction+" is unknown.")}if(E){sap.ca.ui.utils.busydialog.releaseBusyDialog();sap.ca.ui.message.showMessageBox({type:sap.ca.ui.message.Type.ERROR,message:this.Common_i18n.getText("SOLUTION_DIALOG_"+this.dialogAction+"_MSG_ERROR"),details:this.Common_i18n.getText(E)})}else{this._fireEventODataSent()}this.oDialog.destroy()},onSelectOptionCreateOrd:function(e){var m=e.getSource().getParent().getModel();var M=m.getProperty("/MaterialShortageSolutionType");switch(M){case this.Constants.SOLUTIONTYPE_PO_CREATE:case this.Constants.SOLUTIONTYPE_PR_CREATE:if(e.getParameter("selected")){M=this.Constants.SOLUTIONTYPE_PO_CREATE;this.dialogAction=this.Constants.SolutionDialogAction_PO_CREATE}else{M=this.Constants.SOLUTIONTYPE_PR_CREATE;this.dialogAction=this.Constants.SolutionDialogAction_PR_CREATE}break;case this.Constants.SOLUTIONTYPE_TO_CREATE:case this.Constants.SOLUTIONTYPE_TOR_CREATE:if(e.getParameter("selected")){M=this.Constants.SOLUTIONTYPE_TO_CREATE;this.dialogAction=this.Constants.SolutionDialogAction_TO_CREATE}else{M=this.Constants.SOLUTIONTYPE_TOR_CREATE;this.dialogAction=this.Constants.SolutionDialogAction_TOR_CREATE}break}m.setProperty("/MaterialShortageSolutionType",M)}});
